# evostitch-web

> **Note:** This repository serves as the GitHub Pages host for [evostitch.net](https://evostitch.net).
> Development happens in the [evostitch](https://github.com/kenwilliford/evostitch) mono-repo (`web/` directory).
> This repo is synced from `evostitch/web/` when publishing updates.

Web viewer for high-resolution microscopy mosaics generated by [evostitch](https://github.com/kenwilliford/evostitch).

## Features

- OpenSeadragon-based pan/zoom viewer for gigapixel mosaics
- **Z-stack navigation** for 3D mosaics:
  - Slider control
  - Keyboard: ↑/↓ (single plane), PageUp/PageDown (single plane), Home/End (first/last)
  - Shift+Scroll: scroll wheel with Shift held navigates Z-planes
  - Device-aware tile caching and preloading for smooth navigation
- Adaptive scale bar (µm when zoomed in, mm when zoomed out)
- Real-time coordinate display (includes Z position for 3D mosaics)
- Mosaic catalog with thumbnails
- Fullscreen mode
- **Mobile-optimized**: Automatic detection reduces memory usage on phones/tablets

## Usage

### Adding a mosaic

1. Generate DZI tiles using evostitch:
   ```bash
   evostitch dzi -i mosaic.ome.tif -o mosaics/my-mosaic/
   ```

2. Update `mosaics/catalog.json`:
   ```json
   {
     "mosaics": [
       {
         "id": "my-mosaic",
         "title": "My Mosaic",
         "width": 280000,
         "height": 280000,
         "thumbnail": "thumbnail.jpg"
       }
     ]
   }
   ```

3. Optionally add a thumbnail image to the mosaic directory.

### Directory structure

**2D mosaic:**
```
mosaics/
├── catalog.json          # List of available mosaics
└── my-mosaic/
    ├── metadata.json     # Scale and dimension info (from evostitch dzi)
    ├── my-mosaic.dzi     # DZI descriptor
    ├── my-mosaic_files/  # Tile pyramid
    └── thumbnail.jpg     # Optional preview image
```

**3D mosaic (Z-stack):**
```
mosaics/
├── catalog.json
└── my-3d-mosaic/
    ├── metadata.json     # Includes zCount, zSpacing, zLabels
    ├── z_00/             # Z-plane 0 (surface)
    │   ├── mosaic.dzi
    │   └── mosaic_files/
    ├── z_01/             # Z-plane 1
    │   ├── mosaic.dzi
    │   └── mosaic_files/
    └── thumbnail.jpg
```

## Deployment

This is a static site that can be deployed to:
- GitHub Pages
- Cloudflare Pages
- Any static hosting

Tile data should be hosted on a CDN (e.g., Cloudflare R2) for large mosaics.

## Development

Serve locally:
```bash
python -m http.server 8000
```

Then open http://localhost:8000

## License

MIT
